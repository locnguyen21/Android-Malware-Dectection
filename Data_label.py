from Concentrate_file import *
import pandas as pd

#Sau khi loc thuoc tinh, tien xu li, tien hanh boc tach label
#shuffle data truoc roi boc tach label sau ko se bi lon label
#Change_Labeling la dua cac label phan loai nho thanh 5 loai adware, scareware, ransomware, smsmalware, benign
def Change_Labeling(file,label):
    frame = pd.read_csv(file, index_col=None, header=0, low_memory=False)
    #get header
    header = list(frame)
    print(header)
    #chuyen pandas thanh numpy
    frame = frame.values
    #print(type(frame)) #pandas da thanh numpy
    #Change label for adware, scareware, SMSmalware, ransomware and benign
    #benign = 1, adware = 2, scareware = 3, SMSmalware = 4, ransomware = 5
    for i in frame:
        #benign = 1
        # if (label == "benign"):
        #     i[9] = 1
        # #adware = 2
        # elif (label == "adware"):
        #     i[9] = 2
        # elif (label == "scareware"):
        #     i[9] = 3
        # elif (label == "SMSMalware"):
        #     i[9] = 4
        # elif (label == "ransomware"):
        # #scareware = 3
        #     i[9] = 5
        if (label == "benign"):
            i[9] = 1
        elif (label == "malware"):
            i[9] = 0
    #save again to csv file
    #frame = pd.DataFrame(frame, index = None, columns=None )
    #print(frame)
    #print(type(frame))
    pd.DataFrame(frame).to_csv(file, header = header, index=None)
    print("Done!")

def Data_full(source_path,data_path,label_path):
    #tien hanh ghep data va tach label
    frame, a = Concatenate(source_path)
    print(a)
    print(frame)
    #luoc bo cac row thieu gia tri
    print(frame.shape)
    print(frame.isnull().sum())
    frame_clean = frame.dropna()
    print(frame_clean.isnull().sum())
    print(frame_clean.shape)
    #xoa label trong header truoc khi luu vao file data
    #del(a[-1])
    #print(a)
    #data = frame.iloc[:,0:9]
    #label = frame.iloc[:,-1]
    #print(frame.shape)
    #print(data.shape)
    #print(label.shape)
    #pd.DataFrame(data).to_csv(data_path, header = a, index=None)
    #pd.DataFrame(label).to_csv(label_path,header = "Label", index = None)
    pd.DataFrame(frame_clean).to_csv(data_path, header=a, index=None)
    
source_path = 'C:\Android_Malware_Detection\Data\Test'
to_path = "Data\Binary_Test_have_label.csv"
label_path = "Data\Test_label.csv"
Data_full(source_path,to_path,label_path)
