import numpy as np
import pandas as pd
from sklearn.ensemble import RandomForestClassifier
import time
import datetime
import pickle
from Evaluate import *

def Forest():
    frame = pd.read_csv("Data/Train.csv", header=0)
    data = frame.iloc[:, 0:9]
    label = frame.iloc[:, -1]

    print("Load data done!")
    start = time.time()
    print(datetime.datetime.utcnow())
    print("begin traning")

    clf = RandomForestClassifier(n_estimators=100, random_state=0)
    clf.fit(data,label.values.ravel())

    print("training done at:")
    end = time.time()
    print(end-start)
    model = "Model/RandomForest.sav"
    pickle.dump(clf,open(model,'wb'))
    print("save model done")


def TestForest():
    frame = pd.read_csv("Data/Test.csv",header = 0)
    data = frame.iloc[:,0:9]
    label = frame.iloc[:,-1]

    clf = pickle.load(open('Model/RandomForest.sav', 'rb'))
    label = label.values

    result = clf.predict(data)
    return result, label

Forest()
result,label = TestForest()
Evaluate_Model(result,label)

